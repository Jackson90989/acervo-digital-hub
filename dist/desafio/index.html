<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Snake PyScript</title>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: black;
            height: 100vh;
            margin: 0;
            color: white;
            font-family: monospace;
        }
        canvas {
            border: 2px solid white;
        }
    </style>
</head>
<body>
    <py-script>
import random
from js import document, window

# Configurações do jogo
largura, altura = 400, 400
tamanho = 20
velocidade = 200  # delay em ms
x, y = 200, 200
corpo = [(x, y)]
comprimento = 1
direcao = "DIREITA"
pontuacao = 0

# Criar canvas
canvas = document.createElement("canvas")
canvas.width = largura
canvas.height = altura
document.body.appendChild(canvas)
ctx = canvas.getContext("2d")

# Comida
comida_x = random.randrange(0, largura, tamanho)
comida_y = random.randrange(0, altura, tamanho)

# Desenhar função
def desenhar():
    ctx.fillStyle = "black"
    ctx.fillRect(0, 0, largura, altura)

    # desenhar comida
    ctx.fillStyle = "red"
    ctx.fillRect(comida_x, comida_y, tamanho, tamanho)

    # desenhar corpo
    ctx.fillStyle = "green"
    for parte in corpo:
        ctx.fillRect(parte[0], parte[1], tamanho, tamanho)

    # pontuação
    ctx.fillStyle = "white"
    ctx.font = "20px monospace"
    ctx.fillText(f"Pontuação: {pontuacao}", 10, 25)

# Atualizar função
def atualizar(*args):
    global x, y, corpo, comprimento, pontuacao, comida_x, comida_y

    # movimentação
    if direcao == "CIMA":
        y -= tamanho
    elif direcao == "BAIXO":
        y += tamanho
    elif direcao == "ESQUERDA":
        x -= tamanho
    elif direcao == "DIREITA":
        x += tamanho

    # corpo
    corpo.append((x, y))
    if len(corpo) > comprimento:
        corpo.pop(0)

    # colisão comida
    if x == comida_x and y == comida_y:
        comprimento += 1
        pontuacao += 10
        comida_x = random.randrange(0, largura, tamanho)
        comida_y = random.randrange(0, altura, tamanho)

    # colisão parede
    if x < 0 or x >= largura or y < 0 or y >= altura or (x, y) in corpo[:-1]:
        window.alert(f"Fim de jogo! Pontuação final: {pontuacao}")
        x, y = 200, 200
        corpo.clear()
        corpo.append((x, y))
        comprimento = 1
        pontuacao = 0

    desenhar()
    window.setTimeout(atualizar, velocidade)

# Captura teclas
def keydown(event):
    global direcao
    key = event.key
    if key == "ArrowUp" and direcao != "BAIXO":
        direcao = "CIMA"
    elif key == "ArrowDown" and direcao != "CIMA":
        direcao = "BAIXO"
    elif key == "ArrowLeft" and direcao != "DIREITA":
        direcao = "ESQUERDA"
    elif key == "ArrowRight" and direcao != "ESQUERDA":
        direcao = "DIREITA"

document.addEventListener("keydown", keydown)

# iniciar jogo
atualizar()
    </py-script>
</body>
</html>
